<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Account action</title>
  </head>
  <body style="font-family: sans-serif; text-align: center; margin-top: 80px;">
    <h1 id="title">‚úÖ Registration successful</h1>
    <p id="message">Tap the button below to open the app and complete login</p>

    <button
      style="
        font-size:18px;
        padding:12px 24px;
        background:#3ecf8e;
        color:white;
        border:none;
        border-radius:6px;
      "
      onclick="openApp()"
    >
      Open the app
    </button>

    <script>
      function getAllParams() {
        const params = new URLSearchParams(
          window.location.search + window.location.hash.replace("#", "&")
        );
        return params;
      }

      const params = getAllParams();
      const type = params.get("type");
      const error_desc = params.get("error_description");

      let deepLinkBase = "ir.codecomp.dangodong://email-confirmation";
      if (type === "recovery") {
        document.getElementById("title").textContent = "üîê Password reset";
        document.getElementById("message").textContent =
          "Tap the button below to open the app and reset your password";
        deepLinkBase = "ir.codecomp.dangodong://reset-password";
      }

      if (error_desc) {
          document.getElementById("title").textContent = "‚ùåÔ∏è Operation failed";
          document.getElementById("message").textContent = error_desc;
      }

      function openApp() {
        const query = window.location.search || "";
        const hash = window.location.hash || "";
        const deepLink = deepLinkBase + query + hash;

        window.location.href = deepLink;
      }
    </script>
  </body>
</html>
